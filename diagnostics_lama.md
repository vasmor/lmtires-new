# План диагностики модели LaMa

1. **Проверка логов обучения**
   - Найти и проанализировать логи обучения (train.log, events.out.tfevents.* и т.д.).
   - Оценить динамику loss-функций (inpaint_loss, l1_loss, perceptual_loss и др.).

2. **Визуализация результатов на валидации**
   - Найти сохранённые примеры inpainted-результатов на валидации.
   - Сравнить динамику качества по эпохам.

3. **Проверка распределения и структуры масок**
   - Проанализировать, как выглядят маски в train/val-датасете (размер, заполненность, не пустые ли).
   - Визуализировать несколько случайных пар (оригинал, маска, masked_img).

4. **Проверка loss-функций и их весов**
   - Проверить, какие loss-функции и веса используются в конфиге тренировки.
   - Убедиться, что loss считается по правильным областям.

5. **Проверка обучающего скрипта**
   - Убедиться, что на вход генератору подаётся masked_img, а не оригинал.
   - Проверить корректность применения маски (0 — область для восстановления).

6. **Проверка метрик**
   - Посмотреть значения метрик (PSNR, SSIM и др.) во время обучения.
   - Сравнить с эталонными результатами.

7. **Sanity check на обучающих примерах**
   - Прогнать через инференс 1-2 изображения из train-датасета.
   - Сравнить результат с оригиналом.

8. **Проверка структуры checkpoint**
   - Убедиться, что checkpoint содержит обученные веса, а не случайную инициализацию.

9. **Проверка на эталонных данных**
   - Прогнать инференс на публичных примерах из LaMa paper.
   - Сравнить результат с опубликованными эталонами. 